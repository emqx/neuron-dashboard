(window["webpackJsonp_eKuiper"]=window["webpackJsonp_eKuiper"]||[]).push([["chunk-008b6760"],{"3d58":function(e,t,a){"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}a.d(t,"b",(function(){return n}));var n=function(e){var t="WITH (",a=Object.keys(e);return a.forEach((function(a){e[a]&&(t+="".concat(a,'="').concat(e[a],'", '))})),t+=");",t};t["a"]=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var o=function e(t,a){var n="",o=Object.keys(t);o.forEach((function(a,i){if("object"===r(t[a])){var s=e(t[a],!0);n+="".concat(a," ").concat(s)}else n+="".concat(a," ").concat(t[a]);i+1!==o.length&&(n+=", ")}));var i="(\n      ".concat(n,"\n    )");return a?"struct".concat(i):i},i="";return e.forEach((function(e,t){var n=a[t];"object"===r(n)&&(n=o(n)),e&&n&&(i+="".concat(e).concat(n))})),i+=e[e.length-1],i}},"563e":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fields-table"},[e.disabled?e._e():a("Button",{staticClass:"top-create--btn action-add-btn",attrs:{icon:"md-add",type:"primary",ghost:"",disabled:e.onlyOneField},on:{click:e.showModal}},[e._v(" "+e._s(e.$t("common.add"))+" ")]),a("Table",{attrs:{"row-key":"id",columns:e.structCol,data:e.data},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.row,n=t.index;return""===r.name||e.disabled?void 0:["struct"===r.type?a("Button",{staticStyle:{"margin-right":"8px"},attrs:{shape:"circle",type:"primary",size:"small",ghost:""},on:{click:function(t){return e.showModal(r)}}},[e._v(" "+e._s(e.$t("common.add"))+" ")]):e._e(),a("Button",{attrs:{shape:"circle",type:"error",size:"small",ghost:""},on:{click:function(t){return e.removeField(r,n)}}},[e._v(" "+e._s(e.$t("common.delete"))+" ")])]}}],null,!0)}),a("Modal",{attrs:{"class-name":"action-modal--view view-form",title:e.$t("streams.addField"),width:650,"mask-closable":!1},on:{"on-visible-change":e.handleVisibleChange},model:{value:e.viewModalVisible,callback:function(t){e.viewModalVisible=t},expression:"viewModalVisible"}},[e.viewModalVisible?a("Form",{ref:"fieldForm",attrs:{model:e.fieldForm,rules:e.fieldRule}},[a("Row",{attrs:{gutter:20}},[a("i-col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:e.$t("common.name"),prop:"name"}},[a("i-input",{attrs:{size:"large"},model:{value:e.fieldForm.name,callback:function(t){e.$set(e.fieldForm,"name",t)},expression:"fieldForm.name"}})],1)],1),a("i-col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:e.$t("common.type"),prop:"type"}},[a("Select",{attrs:{size:"large"},model:{value:e.fieldForm.type,callback:function(t){e.$set(e.fieldForm,"type",t)},expression:"fieldForm.type"}},e._l(e.typeList,(function(t,r){return a("Option",{key:r,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1),"array"===e.fieldForm.type?a("i-col",{attrs:{span:"12"}},[a("FormItem",{attrs:{label:e.$t("streams.arrayType"),prop:"arrayType"}},[a("Select",{attrs:{size:"large"},model:{value:e.fieldForm.arrayType,callback:function(t){e.$set(e.fieldForm,"arrayType",t)},expression:"fieldForm.arrayType"}},e._l(e.arrayTypeList,(function(t,r){return a("Option",{key:r,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1)],1):e._e()],1)],1):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.viewModalVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),a("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],1)},n=[],o=function(){return Math.random().toString(16).substr(2,8)},i=o,s={name:"FieldsTable",model:{prop:"value",event:"update"},props:{value:{required:!0},isDetail:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},streamFormat:{type:String,default:""}},data:function(){return{viewModalVisible:!1,onlyOneField:!1,fieldForm:{},fieldRule:{name:[{required:!0,message:this.$t("common.fillContent")}],type:[{required:!0,message:this.$t("common.fillContent")}],arrayType:[{required:!0,message:this.$t("common.fillContent")}]},structCol:[{title:this.$t("common.name"),key:"name",tree:!0},{title:this.$t("common.type"),key:"type"},{title:this.$t("common.operations"),slot:"action",width:250}],parentID:"",data:[],typeList:["bigint","float","string","datetime","boolean","array","struct","bytea"],arrayTypeList:["bigint","float","string","datetime","boolean","struct","bytea"]}},watch:{data:{deep:!0,handler:function(e){this.onlyOneField="binary"===this.streamFormat&&1===e.length}},value:{deep:!0,handler:function(e){if(e){var t=0===Object.keys(e).length;t||this.parseToTableData(e)}}},streamFormat:function(e){this.onlyOneField="binary"===e&&1===this.data.length}},methods:{showModal:function(e){e&&(this.parentID=e.id),this.viewModalVisible=!0},handleVisibleChange:function(e){e?this.fieldForm={}:this.parentID=""},parseFormData:function(e){var t=e.name,a=e.type,r=e.arrayType,n={id:i(),name:t,type:a};return"array"===a?n.type="array(".concat(r,")"):"struct"===a&&(n.children=[],n._showChildren=!0),n},findDataAction:function(e,t,a){var r=function t(r){for(var n=0;n<r.length;n+=1){var o=r[n];if(o.id===e){a(o,r,n);break}o.children&&t(o.children)}};r(t)},insertChildData:function(e,t,a){this.findDataAction(e,t,(function(e){e.children.push(a)}))},removeField:function(e){this.findDataAction(e.id,this.data,(function(e,t,a){t.splice(a,1)})),this.parseToModelValue(this.data)},save:function(){var e=this;this.$refs.fieldForm.validate((function(t){if(t){var a=e.parseFormData(e.fieldForm);e.parentID?e.insertChildData(e.parentID,e.data,a):e.data.push(a),e.parseToModelValue(e.data),e.viewModalVisible=!1}}))},parseToModelValue:function(){var e=function e(t){var a={};return t.forEach((function(t){t.children?a[t.name]=e(t.children):a[t.name]=t.type})),a},t=e(this.data);this.$emit("update",t)},parseToTableData:function(e){this.data=this.deconstructData(e)},deconstructData:function(e){var t=this;return Object.keys(e).map((function(a){var r=e[a];if("string"!==typeof r){var n=t.deconstructData(r);return{id:i(),_showChildren:!0,name:a,type:"struct",children:n}}return{id:i(),name:a,type:r}}))}}},c=s,l=a("2877"),u=Object(l["a"])(c,r,n,!1,null,null,null);t["a"]=u.exports},"79a9":function(e,t,a){"use strict";a.r(t);var r,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-details"},[a("div",{staticClass:"page-header"},[a("Breadcrumb",[a("BreadcrumbItem",{attrs:{to:e.getPathForKuiperPage("/nodes/"+e.nodeID+"/source?tabName="+e.prevTabName)}},[e._v(" "+e._s(this.$t("streams.source"))+" ")]),a("BreadcrumbItem",[e._v(e._s(e.accessTitle))])],1),"create"===e.accessType?a("div",{staticClass:"mode-swtich"},[a("label",{attrs:{for:""}},[e._v(e._s(e.isTextMode?e.$t("rules.textMode"):e.$t("rules.visualizationMode")))]),a("i-switch",{on:{change:e.handleClearValidate},model:{value:e.isTextMode,callback:function(t){e.isTextMode=t},expression:"isTextMode"}})],1):e._e()],1),a("Card",{staticClass:"detail",attrs:{shadow:""}},[e.isView?a("div",{staticClass:"view-form"},[e.viewLoading?a("Spin",{attrs:{fix:""}}):e._e(),a("Row",[a("i-col",{attrs:{span:"16"}},[a("div",{staticClass:"view-item"},[a("label",{staticClass:"view-item--label"},[e._v(e._s(e.$t("tables.tableName"))+": ")]),a("span",[e._v(e._s(e.viewForm.name))])]),a("div",{staticClass:"view-item"},[a("label",{staticClass:"view-item--label"},[e._v(e._s(e.$t("tables.tableFields"))+": ")]),a("FieldsTable",{staticClass:"view-item--table",attrs:{isDetail:"view"===e.accessType,disabled:""},model:{value:e.viewForm.tableFields,callback:function(t){e.$set(e.viewForm,"tableFields",t)},expression:"viewForm.tableFields"}})],1),e.viewForm.options?e._l(Object.keys(e.viewForm.options),(function(t,r){return a("div",{key:r,staticClass:"view-item"},[a("label",{staticClass:"view-item--label"},[e._v(e._s(t)+": ")]),a("span",[e._v(e._s(e.viewForm.options[t]))])])})):e._e()],2)],1)],1):a("Form",{ref:"record",attrs:{model:e.createForm,rules:e.rules}},[a("Row",[e.isTextMode?a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:"SQL",prop:"sql"}},[a("div",{staticClass:"monaco-container sql"},[a("Monaco",{ref:"sqlData",attrs:{id:"sql-data",lang:"sql",backgroud:"#282a36",provider:e.dataTypeProvider},model:{value:e.createForm.sql,callback:function(t){e.$set(e.createForm,"sql",t)},expression:"createForm.sql"}})],1)])],1):[a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.tableName"),prop:"name"}},[a("i-input",{attrs:{size:"large",disabled:"edit"===e.accessType},model:{value:e.createForm.name,callback:function(t){e.$set(e.createForm,"name",t)},expression:"createForm.name"}})],1)],1),a("i-col",{attrs:{span:"16"}},[a("i-checkbox",{model:{value:e.isSchemaTable,callback:function(t){e.isSchemaTable=t},expression:"isSchemaTable"}},[e._v(e._s(e.$t("tables.isSchemaType")))])],1),e.isSchemaTable?a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.tableFields"),prop:"tableFields"}},[a("Tooltip",{staticClass:"fields-table--tip",attrs:{"max-width":350,transfer:"",content:e.$t("tables.schemaTip"),placement:"right"}},[a("Icon",{attrs:{type:"md-help-circle"}})],1),a("FieldsTable",{attrs:{isDetail:"edit"===e.accessType,tableFormat:e.createForm.format},model:{value:e.createForm.tableFields,callback:function(t){e.$set(e.createForm,"tableFields",t)},expression:"createForm.tableFields"}})],1)],1):e._e(),a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.tableType"),prop:"tableType"}},[e.sourceInfo.helpUrl?a("a",{attrs:{href:e.i18nLabel(e.sourceInfo.helpUrl),target:"_blank",rel:"noopener"}},[a("Icon",{attrs:{type:"md-document"}}),e._v(" "+e._s(e.$t("common.documentation"))+" ")],1):e._e(),a("ConfKeyTypesSeletor",{attrs:{category:"sources",params:e.isLookupTable?{kind:e.kind}:{}},on:{onChange:e.changeTableType,onSelected:e.handleSourceSelected},model:{value:e.createForm.tableType,callback:function(t){e.$set(e.createForm,"tableType",t)},expression:"createForm.tableType"}})],1)],1),e.dataSourceInfo.label?a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{prop:"dataSource"}},[a("template",{slot:"label"},[a("span",[e._v(e._s(e.i18nLabel(e.dataSourceInfo.label)))])]),e.dataSourceInfo.hint?a("Tooltip",{staticClass:"field-help",attrs:{"max-width":"250px",transfer:"",placement:"top",content:e.i18nLabel(e.dataSourceInfo.hint)}},[e.dataSourceInfo.hint?a("Icon",{attrs:{type:"md-help-circle"}}):e._e()],1):e._e(),a("i-input",{attrs:{size:"large"},model:{value:e.createForm.dataSource,callback:function(t){e.$set(e.createForm,"dataSource",t)},expression:"createForm.dataSource"}})],2)],1):e._e(),a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.confKey"),prop:"confKey"}},[e.createForm.confKey?a("Button",{staticClass:"top-create--btn action-add-btn",attrs:{icon:"ios-create-outline",type:"primary",ghost:""},on:{click:function(t){return e.showConfKeyModel("edit")}}},[e._v(" "+e._s(e.$t("configuration.editConfKey"))+" ")]):e._e(),e.createForm.tableType?a("Button",{staticClass:"top-create--btn action-add-btn",attrs:{icon:"ios-add",type:"primary",ghost:""},on:{click:function(t){return e.showConfKeyModel()}}},[e._v(" "+e._s(e.$t("configuration.addConfKey"))+" ")]):e._e(),a("ConfKeysSelector",{ref:"confKeysSelectorRef",attrs:{category:"sources",type:e.createForm.tableType},on:{"on-open-change":e.handleConfKeyOpen},model:{value:e.createForm.confKey,callback:function(t){e.$set(e.createForm,"confKey",t)},expression:"createForm.confKey"}})],1)],1),a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.format"),prop:"format"}},[a("Select",{attrs:{size:"large"},model:{value:e.createForm.format,callback:function(t){e.$set(e.createForm,"format",t)},expression:"createForm.format"}},e._l(e.formatList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+" ")])})),1)],1)],1),"scan"===e.kind?a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.retainSize"),prop:"retainSize"}},[a("InputNumber",{attrs:{size:"large"},model:{value:e.createForm.retainSize,callback:function(t){e.$set(e.createForm,"retainSize",t)},expression:"createForm.retainSize"}})],1)],1):e._e(),"lookup"===e.kind?a("i-col",{attrs:{span:"16"}},[a("FormItem",{attrs:{label:e.$t("tables.key"),prop:"key"}},[a("i-input",{attrs:{size:"large"},model:{value:e.createForm.key,callback:function(t){e.$set(e.createForm,"key",t)},expression:"createForm.key"}})],1)],1):e._e()],a("i-col",{staticClass:"oper-col",attrs:{span:"16"}},[a("FormItem",[e.isView?e._e():a("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("common.submit")))]),a("Button",{style:e.isView?"":"margin-left: 8px",attrs:{type:"text"},on:{click:e.goBack}},[e._v(" "+e._s(e.$t("common.cancel"))+" ")])],1)],1)],2)],1)],1),e.createForm.tableType?a("ConfKeyPeopertiesModal",{ref:"confKeyPropertiesRef",attrs:{modalVisible:e.confKeyPropertiesVisible,title:e.confKeyModalTitle,category:"sources",type:e.createForm.tableType,confKeyName:e.createForm.confKey,isEdit:e.isEditConfKey},on:{"update:modalVisible":function(t){e.confKeyPropertiesVisible=t},"update:modal-visible":function(t){e.confKeyPropertiesVisible=t},submit:e.submitedConfKey}}):e._e()],1)},o=[],i=a("a34a"),s=a.n(i),c=a("724c"),l=a("510b"),u=a("4041"),d=a("9146"),m=a("ad8f"),f=a("7d99"),p=a("563e"),b=a("94dc"),y=a("ceb0"),h=a("3d58"),v=a("14e2"),T=a("40ee"),F=a("d870");function g(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function w(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){k(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _(e,t,a,r,n,o,i){try{var s=e[o](i),c=s.value}catch(l){return void a(l)}s.done?t(c):Promise.resolve(c).then(r,n)}function I(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function i(e){_(o,r,n,i,s,"next",e)}function s(e){_(o,r,n,i,s,"throw",e)}i(void 0)}))}}function $(e){return E(e)||K(e)||O(e)||C()}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(e,t){if(e){if("string"===typeof e)return D(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?D(e,t):void 0}}function K(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function E(e){if(Array.isArray(e))return D(e)}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var M={name:"TableDetails",components:{Monaco:d["a"],FieldsTable:p["a"],ConfKeyPeopertiesModal:v["a"],ConfKeyTypesSeletor:T["a"],ConfKeysSelector:F["a"]},mixins:[c["a"],u["a"]],data:function(){return{kind:"scan",prevTabName:"scanTable",accessType:this.$route.query.oper,isTextMode:!1,isSchemaTable:!1,viewLoading:!1,viewForm:{},formatList:["json","binary"],confKeyList:[],sourceInfo:{},dataSourceInfo:{default:"",hint:null,label:null},createForm:{name:"",tableType:"",dataSource:"",confKey:"",format:"json",sql:"",retainSize:null,key:"id"},confKeyPropertiesVisible:!1,isEditConfKey:!1}},computed:{isView:function(){var e=this.$route.query.oper;return"view"===e},accessTitle:function(){var e=this.$route.query.oper,t={view:this.$t("common.view"),create:this.$t("common.create"),edit:this.$t("common.edit")};return t[e]},rules:function(){return{name:[{required:!0,message:this.$t("common.fillContent")},{validator:this.validateTableName,trigger:"blur"}],sql:[{required:!0,message:this.$t("common.fillContent")}],tableFields:[{required:!0,message:this.$t("common.fillContent")}],tableType:[{required:this.isLookupTable,message:this.$t("common.fillContent")}]}},dataTypeProvider:function(){return[].concat($(y["a"].sqlKeyWords),$(b["a"]))},confKeyModalTitle:function(){return this.isEditConfKey?this.$t("configuration.editSourceConfKey"):this.$t("configuration.addSourceConfKey")},isLookupTable:function(){return"lookup"===this.kind}},beforeRouteEnter:function(e,t,a){a((function(e){var a="sources"===t.name,r=sessionStorage.getItem("tableForm"),n=sessionStorage.getItem("isSchemaTable");a&&r&&n?(e.createForm=JSON.parse(r),e.isSchemaTable="true"===n):"create"!==e.accessType&&e.loadDetail(),setTimeout((function(){sessionStorage.removeItem("tableForm"),sessionStorage.removeItem("isSchemaTable")}),2e3)}))},created:function(){this.init()},methods:{getPathForKuiperPage:l["b"],init:function(){"create"===this.accessType&&"scan"===this.kind&&(this.createForm.tableType="file",this.changeTableType(this.createForm.tableType))},parseStremFields:function(e){var t=e.TableFields,a=e.StreamFields,r=function e(t){var a={};return t.forEach((function(t){"string"===typeof t.FieldType?a[t.Name]=t.FieldType:"struct"===t.FieldType.Type?a[t.Name]=e(t.FieldType.Fields):"array"===t.FieldType.Type&&(a[t.Name]="".concat(t.FieldType.Type,"(").concat(t.FieldType.ElementType,")"))})),a},n=t||a;return r(n)},loadDetail:function(){var e=this,t=this.$route.params.tableName;this.viewModalVisible=!0,this.viewLoading=!0,Object(m["e"])(this.nodeID,t).then((function(t){var a=t.data,r=a.Name,n=a.Options,o=a.TableFields,i=a.StreamFields,s={};if(o||i?s=e.parseStremFields(a):e.isSchemaTable=!1,"view"===e.accessType)e.viewForm={name:r,options:n,tableFields:s};else{var c=n.DATASOURCE,l=n.datasource,u=n.CONF_KEY,d=n.confKey,m=n.FORMAT,f=n.format,p=n.TYPE,b=n.type,y=n.RETAIN_SIZE,h=n.retainSize,v=n.key;e.createForm={name:r,dataSource:c||l,confKey:u||d,format:m||f,tableType:p||b,retainSize:y||h,key:v,tableFields:s}}e.viewLoading=!1})).then((function(){e.changeTableType(e.createForm.tableType,e.createForm.dataSource)})).catch((function(){e.viewLoading=!1}))},handleConfigSources:function(){sessionStorage.setItem("tableForm",JSON.stringify(this.createForm)),sessionStorage.setItem("isSchemaTable",this.isSchemaTable),this.$router.push({path:"/nodes/".concat(this.nodeID,"/configuration"),query:{oper:this.accessType}})},changeTableType:function(e,t){var a=this;return I(s.a.mark((function r(){var n,o,i;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=4;break}return a.createForm.dataSource="",a.dataSourceInfo={},r.abrupt("return",Promise.resolve());case 4:return r.prev=4,n={nodeID:a.nodeID,name:e},r.next=8,Object(f["f"])("sources",n);case 8:return o=r.sent,i=o.data.dataSource,a.dataSourceInfo=i?w({},i):{},a.createForm.dataSource=t||(null===i||void 0===i?void 0:i.default)||"",r.abrupt("return",Promise.resolve(o));case 15:return r.prev=15,r.t0=r["catch"](4),a.createForm.dataSource="",a.dataSourceInfo={},r.abrupt("return",Promise.reject(r.t0));case 20:case"end":return r.stop()}}),r,null,[[4,15]])})))()},handleSourceSelected:function(e){this.sourceInfo=e?e.about:{}},handleConfKeyOpen:function(e){!this.createForm.tableType&&e&&this.$Message.warning(this.$t("tables.typeFirst"))},showConfKeyModel:function(e){this.isEditConfKey="edit"===e,this.confKeyPropertiesVisible=!0},submitedConfKey:function(e){var t=e.name;this.$refs.confKeysSelectorRef.reload(t)},createTableByKind:function(e){var t=this;Object(m["a"])(this.nodeID,this.kind,e).then((function(e){201===e.status&&"Created"===e.statusText?t.$Message.success(e.data):t.$Message.success(t.$t("common.addSuccess")),t.goBack()}))},updateTableByKind:function(e){var t=this,a={id:this.createForm.name,kind:this.kind};Object(m["d"])(this.nodeID,a,e).then((function(){t.$Message.success(t.$t("common.editSuccess")),t.goBack()}))},save:function(){var e=this;this.$refs.record.validate((function(t){if(t){var a={sql:""};if(e.isTextMode)a.sql=e.createForm.sql;else{var n=e.createForm,o=n.name,i=n.tableFields,s=n.confKey,c=n.format,l=n.dataSource,u=n.tableType,d=n.retainSize,m=n.key,f="CREATE TABLE ".concat(o),p=i||"()",b={DATASOURCE:l,FORMAT:c,CONF_KEY:s,TYPE:u,KIND:e.kind||"scan"};"scan"===e.kind?b=w(w({},b),{},{RETAIN_SIZE:d}):"lookup"===e.kind&&(b=w(w({},b),{},{KEY:m}));var y=Object(h["b"])(b);a.sql=Object(h["a"])(r||(r=g(["\n              ","\n              ","\n              ","\n          "])),f,p,y)}"create"===e.accessType?e.createTableByKind(a):e.updateTableByKind(a)}}))},validateTableName:function(e,t,a){/\s/.test(t)?a(new Error(this.$t("tables.tableNameSpace"))):a()},handleClearValidate:function(){var e=this;setTimeout((function(){e.$refs.record.resetFields()}),1e3)},routeToInstallPage:function(e){this.$router.push({name:"plugins",params:{id:this.nodeID},query:{fromPage:"table"}});var t={fromType:"sources",pluginName:e};sessionStorage.setItem("installInfo",JSON.stringify(t))},goBackPage:function(e){this.$router.push({name:"source",params:{id:this.nodeID},query:{tabName:e}})},goBack:function(){this.goBackPage(this.prevTabName)}}},x=M,j=(a("aabf"),a("2877")),A=Object(j["a"])(x,n,o,!1,null,null,null);t["default"]=A.exports},"94dc":function(e,t,a){"use strict";var r=a("12cb"),n=a("4360"),o=n["a"].state.lang,i=r["default"][o],s=[],c=["bigint","float","string","datetime","boolean","array","struct"];c.forEach((function(e){var t={name:e,detail:"Kuiper ".concat(i.sql.dataType),type:"Field",documentation:i.sql[e],valueType:""};s.push(t)})),t["a"]=s},aabf:function(e,t,a){"use strict";a("caa10")},ad8f:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return l}));var r=a("751a"),n=a("510b"),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].get(Object(n["c"])(e,"/tables"),{params:t})},i=function(e,t){return r["a"].get(Object(n["c"])(e,"/tables/".concat(t)))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"scan",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].post(Object(n["c"])(e,"/tables?kind=".concat(t)),a)},c=function(e,t){return r["a"].delete(Object(n["c"])(e,"/tables/".concat(t)))},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r["a"].put(Object(n["c"])(e,"/tables/".concat(t.id,"?kind=").concat(t.kind)),a)}},caa10:function(e,t,a){},ceb0:function(e,t,a){"use strict";var r=a("12cb"),n=a("4360"),o=n["a"].state.lang,i=r["default"][o],s=[],c=[],l=["CREATE","WITH","DATASOURCE","KEY","FORMAT","CONF_KEY","TYPE","STRICT_VALIDATION","STREAM","STREAMS","TABLE","TABLES"],u=["SELECT","FROM","JOIN","LEFT","INNER","ON","WHERE","GROUP","ORDER","HAVING","BY","ASC","DESC","AND","OR","AS","RROP","EXPLAIN","DESCRIBE","SHOW","WITH","BIGINT","FLOAT","STRING","DATETIME","BOOLEAN","ARRAY","STRUCT","TRUE","FALSE","DD","HH","MI","SS","MS"],d=function(e,t){e.forEach((function(e){var a={name:e,type:"Keyword",detail:"SQL ".concat(i.sql.keyWord),documentation:""};t.push(a)}))};d(l,s),d(u,c),t["a"]={sqlKeyWords:s,ruleSqlKeyWords:c}},d870:function(e,t,a){"use strict";var r=a("a34a"),n=a.n(r),o=a("f065"),i=a("724c"),s=a("7d99");function c(e,t,a,r,n,o,i){try{var s=e[o](i),c=s.value}catch(l){return void a(l)}s.done?t(c):Promise.resolve(c).then(r,n)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(r,n){var o=e.apply(t,a);function i(e){c(o,r,n,i,s,"next",e)}function s(e){c(o,r,n,i,s,"throw",e)}i(void 0)}))}}var u,d,m={name:"ConfKeySelector",extends:o["a"],props:{category:{type:String,default:"sources"},type:{type:String,default:""}},mixins:[i["a"]],watch:{type:{immediate:!0,handler:function(e){e?this.init():(this.myValue="",this.list=[])}}},created:function(){},methods:{init:function(){var e=this;return l(n.a.mark((function t(){var a;return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getList();case 2:e.list=t.sent,a=e.list.find((function(t){return t===e.myValue})),a||(e.myValue="");case 5:case"end":return t.stop()}}),t)})))()},getList:function(){var e=this;return new Promise((function(t,a){if(e.type){var r={nodeID:e.nodeID,name:e.type};Object(s["g"])(e.category,r).then((function(e){var a=e.data,r=Object.keys(a);t(r)})).catch((function(e){a(e)}))}else t([])}))}}},f=m,p=a("2877"),b=Object(p["a"])(f,u,d,!1,null,null,null);t["a"]=b.exports}}]);