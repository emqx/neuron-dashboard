(window["webpackJsonp_eKuiper"]=window["webpackJsonp_eKuiper"]||[]).push([["chunk-38117ab0"],{"50fc":function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return s})),a.d(t,"j",(function(){return i})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"i",(function(){return m})),a.d(t,"g",(function(){return f}));var r=a("751a"),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r["a"].get("/users",{params:e})},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r["a"].post("/users",e)},s=function(e){return r["a"].delete("/users/".concat(e))},i=function(e){return r["a"].get("/users/".concat(e))},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].put("/users/".concat(e),t)},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r["a"].get("/roles",{params:e})},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r["a"].post("/roles",e)},d=function(e){return r["a"].delete("/roles/".concat(e))},m=function(e){return r["a"].get("/roles/".concat(e))},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r["a"].put("/roles/".concat(e),t)}},c785:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"users"},[a("div",{staticClass:"page-header"},[a("h1",[e._v(e._s(e.$t("admin.admin")))]),a("Button",{staticClass:"top-create--btn",attrs:{type:"primary",icon:"md-add"},on:{click:e.showCreateModal}},[e._v(e._s(e.$t("admin.createUser")))])],1),a("Table",{attrs:{loading:e.loading,columns:e.recordsCol,data:e.records}}),e.total>=10?a("Page",{attrs:{"show-total":"",current:e.page,total:e.total,"page-size":e.limit},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange}}):e._e(),a("Modal",{attrs:{"class-name":"users-modal--create",title:e.isEdit?e.$t("admin.editUser"):e.$t("admin.createUser"),width:480,"mask-closable":!1},model:{value:e.createModalVisible,callback:function(t){e.createModalVisible=t},expression:"createModalVisible"}},[a("Form",{ref:"createForm",attrs:{model:e.createForm,rules:e.rules}},[a("Row",[a("i-col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:e.$t("admin.role"),prop:"roleId"}},[a("Select",{attrs:{size:"large"},model:{value:e.createForm.roleId,callback:function(t){e.$set(e.createForm,"roleId",t)},expression:"createForm.roleId"}},e._l(e.rolesList,(function(e){return a("Option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)],1),a("i-col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:e.$t("admin.username"),prop:"username"}},[a("i-input",{attrs:{size:"large"},model:{value:e.createForm.username,callback:function(t){e.$set(e.createForm,"username",t)},expression:"createForm.username"}})],1)],1),a("i-col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:e.$t("common.password"),prop:"password"}},[a("i-input",{attrs:{type:"password",size:"large"},model:{value:e.createForm.password,callback:function(t){e.$set(e.createForm,"password",t)},expression:"createForm.password"}})],1)],1),a("i-col",{attrs:{span:"24"}},[a("FormItem",{attrs:{label:e.$t("common.confirmPassword"),type:"password",prop:"confirmPassword"}},[a("i-input",{attrs:{type:"password",size:"large"},model:{value:e.createForm.confirmPassword,callback:function(t){e.$set(e.createForm,"confirmPassword",t)},expression:"createForm.confirmPassword"}})],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:function(t){e.createModalVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),a("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("common.submit")))])],1)],1)],1)},o=[],n=a("50fc"),s={name:"Users",data:function(){var e=this,t=(this.$createElement,function(t,a,r){""===a?r(new Error(e.$t("common.pleaseEnterYourPasswordAgain"))):a!==e.createForm.password?r(new Error(e.$t("common.confirmNotMatch"))):r()});return{loading:!1,createModalVisible:!1,isEdit:!1,page:1,limit:10,total:0,createForm:{},rolesList:[],rules:{roleId:[{required:!0,message:this.$t("common.fillContent")}],username:[{required:!0,message:this.$t("common.fillContent")}],password:[{required:!0,message:this.$t("common.fillContent")}],confirmPassword:[{required:!0,message:this.$t("common.pleaseEnterYourPasswordAgain")},{validator:t,trigger:"blur"}]},records:[],recordsCol:[{title:this.$t("admin.username"),key:"username"},{title:this.$t("admin.role"),key:"roleId",render:function(t,a){var r=e.findRoleName(a.row.roleId);return t("div",[r])}},{title:this.$t("common.operations"),key:"action",width:300,align:"center",render:function(t,a){var r="admin"===a.row.username,o=t("div",[t("a",{attrs:{href:"javascript:;"},style:"margin-right: 10px;",on:{click:function(){e.showDetail(a.row)}}},[t("Icon",{attrs:{type:"ios-create"}})]),t("a",{attrs:{href:"javascript:;"}},[t("Poptip",{attrs:{confirm:!0,transfer:!0,width:200,title:e.$t("common.confirmDelete"),placement:"top",type:"error"},on:{"on-ok":function(){e.remove(a.row)},"on-cancel":function(){}}},[t("Icon",{attrs:{type:"md-trash"}})])])]);return r?"":o}}]}},watch:{createModalVisible:function(e){e||(this.$refs.createForm.resetFields(),this.isEdit=!1,this.createForm={})}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.loading=!0,Object(n["f"])({$limit:this.limit,$skip:(this.page-1)*this.limit}).then((function(t){e.records=t.data.data,e.total=t.data.total,e.loading=!1})).catch((function(){e.loading=!1})),Object(n["e"])({$limit:100}).then((function(t){e.rolesList=t.data.data.map((function(e){return{label:e.name,value:e.id}}))})).catch((function(){}))},showDetail:function(e){var t=this,a=e.id;this.createModalVisible=!0,this.isEdit=!0,Object(n["j"])(a).then((function(e){t.createForm=e.data})).catch((function(){}))},remove:function(e){var t=this,a=e.id;Object(n["d"])(a).then((function(){t.$Message.success(t.$t("common.deleteSuccess")),t.page=1,t.loadData()})).catch((function(){}))},showCreateModal:function(){this.createModalVisible=!0},save:function(){var e=this;this.$refs.createForm.validate((function(t){if(t){var a=e.createForm,r=a.id,o=a.roleId,s=a.username,i=a.password,c={roleId:o,username:s,password:i};e.isEdit?Object(n["h"])(r,c).then((function(){e.$Message.success(e.$t("common.editSuccess")),e.loadData(),e.createModalVisible=!1})).catch((function(){})):Object(n["b"])(c).then((function(){e.$Message.success(e.$t("common.addSuccess")),e.loadData(),e.createModalVisible=!1}))}}))},findRoleName:function(e){var t=this.rolesList.find((function(t){return t.value===e}));return t?t.label:""},handlePageChange:function(e){this.page=e,this.loadData()},handlePageSizeChange:function(e){this.limit=e,this.page=1,this.loadData()}}},i=s,c=a("2877"),l=Object(c["a"])(i,r,o,!1,null,null,null);t["default"]=l.exports}}]);